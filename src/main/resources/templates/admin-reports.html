<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Admin Reports | Hotel Reservation System</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      rel="stylesheet"
    />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
      body {
        background: linear-gradient(to right, #1f1c2c, #928dab);
        font-family: "Poppins", sans-serif;
        color: #fff;
        min-height: 100vh;
      }

      .navbar {
        background-color: #212529;
        padding: 12px 25px;
      }

      .navbar-brand {
        font-weight: bold;
        color: #f8f9fa !important;
      }

      .card {
        background: #ffffff;
        border: none;
        border-radius: 15px;
        color: #333;
        transition: transform 0.3s, box-shadow 0.3s;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      }

      .icon-circle {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        color: white;
      }

      .bg-hotel {
        background: #0d6efd;
      }
      .bg-user {
        background: #198754;
      }
      .bg-booking {
        background: #ffc107;
        color: #333;
      }
      .bg-payment {
        background: #dc3545;
      }

      .chart-container {
        background: #fff;
        color: #333;
        border-radius: 15px;
        padding: 25px;
        margin-top: 30px;
      }

      .table-container {
        background: #fff;
        border-radius: 15px;
        padding: 25px;
        color: #333;
        margin-top: 30px;
      }

      footer {
        text-align: center;
        padding: 20px;
        color: #ddd;
        margin-top: 50px;
      }
    </style>
  </head>

  <body>
    <!-- üîπ Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="/admin-dashboard">
          <i class="fas fa-user-shield"></i> Admin Panel
        </a>
        <div class="d-flex">
          <a href="/admin-dashboard" class="btn btn-outline-light btn-sm me-2">
            <i class="fas fa-home"></i> Dashboard
          </a>
          <a th:href="@{/logout}" class="btn btn-danger btn-sm">
            <i class="fas fa-sign-out-alt"></i> Logout
          </a>
        </div>
      </div>
    </nav>

    <!-- üîπ Main Section -->
    <div class="container py-5">
      <h2 class="text-center fw-bold mb-4">üìà Admin Statistics & Reports</h2>

      <!-- üî∏ Summary Cards -->
      <div class="row g-4 mb-5">
        <div class="col-md-3">
          <div class="card text-center p-3">
            <div class="icon-circle bg-hotel mx-auto mb-3">
              <i class="fas fa-hotel"></i>
            </div>
            <h5>Total Hotels</h5>
            <h3 th:text="${hotelCount}">25</h3>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center p-3">
            <div class="icon-circle bg-user mx-auto mb-3">
              <i class="fas fa-users"></i>
            </div>
            <h5>Registered Users</h5>
            <h3 th:text="${userCount}">124</h3>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center p-3">
            <div class="icon-circle bg-booking mx-auto mb-3">
              <i class="fas fa-calendar-check"></i>
            </div>
            <h5>Total Bookings</h5>
            <h3 th:text="${bookingCount}">80</h3>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card text-center p-3">
            <div class="icon-circle bg-payment mx-auto mb-3">
              <i class="fas fa-credit-card"></i>
            </div>
            <h5>Total Payments</h5>
            <h3 th:text="${paymentCount}">67</h3>
          </div>
        </div>
      </div>

      <!-- üî∏ Booking Trends Chart -->
      <div class="chart-container">
        <h4 class="mb-3">üìä Booking Trends</h4>
        <canvas id="bookingChart"></canvas>
      </div>

      <!-- üî∏ Top Hotels & Recent Bookings -->
      <div class="row mt-4">
        <div class="col-lg-6">
          <div class="chart-container">
            <h5>üè® Most Booked Hotels</h5>
            <canvas id="hotelChart"></canvas>
          </div>
        </div>
        <div class="col-lg-6">
          <div class="table-container">
            <h5>üßæ Recent Bookings</h5>
            <table class="table table-striped table-hover align-middle">
              <thead class="table-dark">
                <tr>
                  <th>ID</th>
                  <th>User</th>
                  <th>Hotel</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="booking : ${recentBookings}">
                  <td th:text="${booking.id}">1</td>
                  <td th:text="${booking.user.username}">imamdeen</td>
                  <td th:text="${booking.hotel.name}">Taj Hotel</td>
                  <td>
                    <span
                      th:text="${booking.status}"
                      th:classappend="${booking.status == 'CONFIRMED'} ? 'badge bg-success' : 'badge bg-danger'"
                    >
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- üîπ Footer -->
    <footer>
      &copy; 2025 Hotel Reservation System | Admin Reports Dashboard
    </footer>

    <!-- Chart.js -->
    <script>
      // Booking Trends Chart
      const ctx1 = document.getElementById("bookingChart");
      new Chart(ctx1, {
        type: "line",
        data: {
          labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
          datasets: [
            {
              label: "Monthly Bookings",
              data: [12, 19, 8, 25, 30, 22],
              borderColor: "#0d6efd",
              backgroundColor: "rgba(13, 110, 253, 0.2)",
              tension: 0.3,
              fill: true,
            },
          ],
        },
        options: { scales: { y: { beginAtZero: true } } },
      });

      // Most Booked Hotels Chart
      const ctx2 = document.getElementById("hotelChart");
      new Chart(ctx2, {
        type: "bar",
        data: {
          labels: [
            "Taj",
            "Leela Palace",
            "Star Hotel",
            "Grand Hyatt",
            "Diamond",
          ],
          datasets: [
            {
              label: "Bookings",
              data: [20, 15, 10, 8, 5],
              backgroundColor: [
                "#0d6efd",
                "#198754",
                "#ffc107",
                "#dc3545",
                "#6610f2",
              ],
            },
          ],
        },
        options: {
          scales: { y: { beginAtZero: true } },
          plugins: { legend: { display: false } },
        },
      });
    </script>

    <!-- Bootstrap Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
